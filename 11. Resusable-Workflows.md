# Reusable Workflows in GitHub Actions

Reusable workflows allow you to define a workflow in one repository that can be referenced and executed by other workflows, either in the same repository or across different repositories. This promotes code reuse, reduces duplication, and makes maintenance easier.

## Key Features

1. **Call workflows from other workflows**
2. **Share workflows across repositories**
3. **Pass inputs and secrets to called workflows**
4. **Receive outputs from called workflows**

## Basic Syntax

```yaml
jobs:
  call-reusable-workflow:
    uses: OWNER/REPO/.github/workflows/WORKFLOW_FILE.yml@BRANCH
    with:
      input1: value1
      input2: value2
    secrets:
      secret1: ${{ secrets.SECRET_NAME }}
```

## Examples

### Example 1: Basic Reusable Workflow

**Reusable workflow (in .github/workflows/shared.yml):**
```yaml
name: Shared CI Pipeline

on:
  workflow_call:
    inputs:
      node-version:
        required: true
        type: string
      environment:
        required: false
        type: string
        default: 'staging'

jobs:
  build-and-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Use Node.js ${{ inputs.node-version }}
        uses: actions/setup-node@v3
        with:
          node-version: ${{ inputs.node-version }}
          
      - run: npm install
      - run: npm test
      
      - name: Show environment
        run: echo "Deploying to ${{ inputs.environment }}"
```

**Calling workflow:**
```yaml
name: Main CI Pipeline

on: [push]

jobs:
  call-shared-workflow:
    uses: ./.github/workflows/shared.yml
    with:
      node-version: '18.x'
      environment: 'production'
```

### Example 2: Cross-Repository Reusable Workflow

**Reusable workflow (in org/shared-repo):**
```yaml
name: Shared Deployment

on:
  workflow_call:
    inputs:
      target-env:
        required: true
        type: string
    secrets:
      api-token:
        required: true

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to ${{ inputs.target-env }}
        run: |
          echo "Deploying to ${{ inputs.target-env }}"
          echo "Using API token ${{ secrets.api-token }}"
```

**Calling workflow (in another repo):**
```yaml
name: Product Deployment

on: [push]

jobs:
  call-shared-deployment:
    uses: my-org/shared-repo/.github/workflows/deploy.yml@main
    with:
      target-env: 'production'
    secrets:
      api-token: ${{ secrets.PRODUCTION_TOKEN }}
```

### Example 3: Reusable Workflow with Outputs

**Reusable workflow:**
```yaml
name: Generate Build Info

on:
  workflow_call:
    outputs:
      build-id:
        description: "The generated build ID"
        value: ${{ jobs.generate.outputs.build-id }}

jobs:
  generate:
    runs-on: ubuntu-latest
    outputs:
      build-id: ${{ steps.generate-id.outputs.build-id }}
    steps:
      - id: generate-id
        run: echo "::set-output name=build-id::$(date +%s)"
```

**Calling workflow:**
```yaml
name: Main Build Pipeline

on: [push]

jobs:
  get-build-id:
    uses: ./.github/workflows/generate-build-info.yml
  
  use-build-id:
    needs: get-build-id
    runs-on: ubuntu-latest
    steps:
      - run: echo "The build ID is ${{ needs.get-build-id.outputs.build-id }}"
```
---

GitHub Actions **does support a similar concept to Jenkins Shared Libraries** via **[Reusable Workflows](https://docs.github.com/en/actions/using-workflows/reusing-workflows)** and **[Composite Actions](https://docs.github.com/en/actions/creating-actions/creating-a-composite-action)**.

Letâ€™s break this down:

---

## âœ… 1. **Reusable Workflows** (like Jenkins Shared Pipelines)

### ðŸ“Œ What is it?

A **reusable workflow** is a full `.yml` workflow that can be **called from other workflows** â€” just like calling a shared pipeline.

### ðŸ“¦ Example Structure:

```
.github/
  workflows/
    deploy.yml          <-- Calls reusable workflow
  reusable/
    deploy-template.yml <-- Reusable workflow
```

---

### ðŸ”§ `deploy-template.yml` (Reusable Workflow)

```yaml
# .github/reusable/deploy-template.yml
name: Deploy Template

on:
  workflow_call:
    inputs:
      environment:
        required: true
        type: string

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - run: echo "Deploying to ${{ inputs.environment }}"
```

---

### ðŸ”§ `deploy.yml` (Calling Workflow)

```yaml
# .github/workflows/deploy.yml
name: Call Reusable Workflow

on: [push]

jobs:
  call-deploy:
    uses: ./.github/reusable/deploy-template.yml
    with:
      environment: production
```

---

## âœ… 2. **Composite Actions** (like Jenkins Shared Steps or Stages)

### ðŸ“Œ What is it?

A **composite action** is a custom action made from multiple steps. These can be reused in many workflows â€” like **shared stage definitions**.

### ðŸ“¦ Folder Structure:

```
.github/
  actions/
    say-hello/
      action.yml
```

---

### ðŸ”§ `action.yml` (Composite Action)

```yaml
# .github/actions/say-hello/action.yml
name: Say Hello
description: Reusable greeting action
runs:
  using: "composite"
  steps:
    - run: echo "Hello, ${{ inputs.name }}!"
inputs:
  name:
    required: true
```

---

### ðŸ”§ Using Composite Action

```yaml
# .github/workflows/main.yml
name: Use Composite Action

on: [push]

jobs:
  greet:
    runs-on: ubuntu-latest
    steps:
      - uses: ./.github/actions/say-hello
        with:
          name: Deepak
```

---

## ðŸš€ Summary

| Feature           | Jenkins          | GitHub Actions Equivalent |
| ----------------- | ---------------- | ------------------------- |
| Shared Pipeline   | Shared Libraries | **Reusable Workflows**    |
| Shared Step/Stage | Step libraries   | **Composite Actions**     |

---

## ðŸ“š Official Docs

* ðŸ”— [Reusable Workflows](https://docs.github.com/en/actions/using-workflows/reusing-workflows)
* ðŸ”— [Composite Actions](https://docs.github.com/en/actions/creating-actions/creating-a-composite-action)

---


## Reference Links

1. [GitHub Docs: Reusing workflows](https://docs.github.com/en/actions/using-workflows/reusing-workflows) - Official documentation
2. [GitHub Docs: workflow_call trigger](https://docs.github.com/en/actions/learn-github-actions/events-that-trigger-workflows#workflow-reuse-events) - About the workflow_call trigger
3. [GitHub Blog: Reusable workflows GA](https://github.blog/2021-11-29-github-actions-reusable-workflows-is-generally-available/) - Announcement of the feature

Reusable workflows are particularly useful for:
- Standardizing CI/CD pipelines across multiple repositories
- Sharing common build/test/deploy patterns
- Reducing maintenance overhead for similar workflows
- Enforcing consistent practices across an organization
