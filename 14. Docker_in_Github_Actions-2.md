### âœ… Using Docker Containers **in Steps** (Not as Job-level Containers)

Sometimes you donâ€™t want the **entire job** to run in a Docker container â€” instead, you want to **run specific steps** in their own container. This is useful for:

* Running isolated tools (e.g., Terraform, Trivy, Kubectl).
* Avoiding environment pollution.
* Avoiding custom runners.

---

### ðŸ”¹ Method: `uses: docker://<image>` in a step

GitHub Actions allows you to run a **step inside a Docker container** directly using this syntax:

```yaml
- name: Run in container
  uses: docker://<image-name>
```

---

### âœ… Example: Run a Step Using Alpine Container

```yaml
name: Step with Docker Container

on: [push]

jobs:
  docker-step:
    runs-on: ubuntu-latest
    steps:
      - name: Hello from Alpine
        uses: docker://alpine:latest
        with:
          args: echo "Hello from inside a Docker container!"
```

> ðŸ”¸ `args:` provides the command to run inside the container.

---

### âœ… Example: Use Trivy Container to Scan for Vulnerabilities

```yaml
name: Trivy Security Scan

on: [push]

jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Run Trivy scan
        uses: docker://aquasec/trivy:latest
        with:
          args: fs --exit-code 1 --severity HIGH,CRITICAL .
```

> This will run `trivy` inside its own official container, scanning your codebase in the GitHub workspace.

---

### âœ… Example: Use Custom Docker Image with Environment Variables

```yaml
jobs:
  example:
    runs-on: ubuntu-latest
    steps:
      - name: Run in Node Container
        uses: docker://node:20
        env:
          ENV_VAR: production
        with:
          args: node -e "console.log(process.env.ENV_VAR)"
```

---

### âš  Notes:

* This **does not support multiple commands** or `run:` blocks like native steps.
* It does **not mount your workspace** by default, so you canâ€™t access files unless you:

  * Mount them manually in your Dockerfile
  * Or use full job containers instead (via `container:`)

---

### ðŸ”— Official References

* **GitHub Docs â€“ Docker container actions**
  [https://docs.github.com/en/actions/creating-actions/creating-a-docker-container-action](https://docs.github.com/en/actions/creating-actions/creating-a-docker-container-action)

* **Docker Hub Image URLs (for docker://)**
  [https://hub.docker.com/](https://hub.docker.com/)

---

